<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Pathfinding with Yelp and Google Directions APIs</title>
  <meta name="description" content="It’s Friday and you’re headed into the city to meet a friend. You jump on Yelp to search for some new spots to check out, but you’re left wondering: Which on...">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400" rel="stylesheet">
  <link rel="stylesheet" href="../../styles/main.css">
  <link rel="canonical" href="https://www.joemcilhargey.com/articles/pathfinding-with-yelp-and-google-directions-apis">
  <link rel="alternate" type="application/rss+xml" title="Articles" href="https://www.joemcilhargey.com/articles/feed.xml">
</head>

  <body>
    <svg display="none">
	<defs>
		<g id="svg-menu">
		 	<path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
	      	<path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
	      	<path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
		</g>
		<g id="svg-github">
			<path d="M1664 896q0 251-146.5 451.5t-378.5 277.5q-27 5-39.5-7t-12.5-30v-211q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 89t.5 54q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"/>
		</g>
		<g id="svg-freecodecamp">
			<path d="M1600 1696v64q0 13-9.5 22.5t-22.5 9.5h-1344q-13 0-22.5-9.5t-9.5-22.5v-64q0-13 9.5-22.5t22.5-9.5h1344q13 0 22.5 9.5t9.5 22.5zm-256-1056q0 78-24.5 144t-64 112.5-87.5 88-96 77.5-87.5 72-64 81.5-24.5 96.5q0 96 67 224l-4-1 1 1q-90-41-160-83t-138.5-100-113.5-122.5-72.5-150.5-27.5-184q0-78 24.5-144t64-112.5 87.5-88 96-77.5 87.5-72 64-81.5 24.5-96.5q0-94-66-224l3 1-1-1q90 41 160 83t138.5 100 113.5 122.5 72.5 150.5 27.5 184z"/>
		</g>
		<g id="svg-linkedin">
			<path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/>
		</g>
	</defs>
</svg>
    <div class="header-wrapper">
  <header class="site-header">
    <div class="header-name">
      <h2><a href="/">Joe McIlhargey</a></h2>
      <small>Full Stack Developer</small>
    </div>
    <nav class="header-nav">
      <ul class="nav-pages">
        <li><a href="/">Projects</a></li>
        <li><a href="/articles/index.html">Articles</a></li>
        <li><a href="/about">About</a></li>
      </ul>
      <ul class="nav-socials">
        <li>
          <a class="socials-github" href="https://github.com/jmcilhargey">
            <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
              <use xlink:href="#svg-github"/>
            </svg>
          </a>
        </li>
        <li>
          <a class="socials-linkedin" href="https://www.linkedin.com/in/joemcilhargey">
            <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
              <use xlink:href="#svg-linkedin"/>
            </svg>
          </a>
        </li>
        <li>
          <a class="socials-freecodecamp" href="http://www.freecodecamp.com/jmcilhargey">
            <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
              <use xlink:href="#svg-freecodecamp"/>
            </svg>
          </a>
        </li>
      </ul>
    </nav>
    <button class="nav-menu" onclick="toggleDrawerMenu(this,event)" ontouchstart="toggleDrawerMenu(this,event)">
      <svg viewBox="0 0 18 15">
        <use xlink:href="#svg-menu" />
      </svg>
    </button>
  </header>
</div>
    <main class="site-content">
      <div class="article-container">
        <article class="article-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
    
    <h1 class="article-title" itemprop="name headline">Pathfinding with Yelp and Google Directions APIs</h1>
  </header>

  <div class="article-content" itemprop="articleBody">
    <p>It’s Friday and you’re headed into the city to meet a friend. You jump on Yelp to search for some new spots to check out, but you’re left wondering: Which ones should we go to first and what’s going to be the best route? With a couple of hours to kill, we can build an web app to tell us.</p>

<p>In this tutorial, we’ll create a web application with a Node.js API. Our API will communicate with the Yelp and Google Directions APIs to request info and directions for local nightlife. The information we get back will be used to generate a Google Map showing the best order and route to take based on Google’s algorithm. You can view the demo app <a href="https://local-nightlife.herokuapp.com/">here</a> and see the source on <a href="https://github.com/jmcilhargey/nightlife-app">GitHub</a>. (Due to length, this tutorial won’t cover Google auth or MongoDB database queries.)</p>

<img class="article-image" src="../imgs/pathfinding-google-yelp.png"></img>

<p>We’ll start by creating a server with Express.js to handle API requests from our users. Express.js is a web application framework for Node.js that provides methods and middleware to make tasks like creating a server, setting up routes, and receiving client data easier. Middleware are methods that can access the client request and the server response objects. After performing an action, a middleware method can call the next item in a middleware chain. In general, middleware is implemented by calling <mark>use()</mark> on the Express server.</p>

<p>Mongoose is an optional tool for MongoDB that allows us to define a model for data we save to the DB. Body-parser is an Express middleware that populates the <mark>request.body</mark> property with JSON data we’ll send from the client via <mark>XMLHttpRequest()</mark>. The <mark>process.env</mark> variables are used to store private keys or configuration variables, like when deploying to a cloud platform.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"express"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"mongoose"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"body-parser"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_URI</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s2">"/"</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Listening on port "</span> <span class="o">+</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="p">);</span>
<span class="p">});</span></code></pre></figure>

<p>The <mark>express.static</mark> is a built-in middleware in Express that takes a directory to serve static content from. Here we just use the root direction <mark>__dirname</mark>. In a production app, it’s a good practice to have a directory to house static assets. We don’t have routes to receive API requests yet, so we’ll have define them after we build modules for the Yelp and Google Directions API. We’ll need to send long URLs for GET requests to Yelp and Google so let’s make a helper method we can import into our script to URL-ize an object of parameters.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// File name used for import is serialize.js</span>

<span class="s2">"use strict"</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">components</span> <span class="o">=</span> <span class="p">[];</span>

	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">object</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
			
			<span class="nx">components</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">object</span><span class="p">[</span><span class="nx">key</span><span class="p">]));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nx">components</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">"&amp;"</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>With <a href="https://www.yelp.com/developers/documentation/v2/overview">Yelp’s API</a>, we can access over 50 million business records in the US and abroad. Yelp is among a number of companies now using OAuth to authenticate API users. Rather than hand-writing code to request a token, we can use the popular and trusted <mark>oauth</mark> library on NPM. We’ll use a promise object as a convenient way to return the result, fulfilled or rejected, for the asynchronous GET request. In our Express server, we’ll be able to call the <mark>then()</mark> method on this returned promise to access the data (or error reason).</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// File name used for import is yelp.js</span>

<span class="s2">"use strict"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">stringToUrl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./serialize.js"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"oauth"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">OAuth</span> <span class="o">=</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">OAuth</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">searchCity</span><span class="p">,</span> <span class="nx">sortBy</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kd">var</span> <span class="nx">baseUrl</span> <span class="o">=</span> <span class="s2">"https://api.yelp.com/v2/search/json"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">location</span><span class="p">:</span> <span class="nx">searchCity</span><span class="p">,</span>
            <span class="na">sort</span><span class="p">:</span> <span class="nx">sortBy</span><span class="p">,</span>
            <span class="na">limit</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="na">category_filter</span><span class="p">:</span> <span class="s2">"nightlife"</span>
        <span class="p">};</span>
            
        <span class="kd">var</span> <span class="nx">promise</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">new</span> <span class="nx">OAuth</span><span class="p">(</span>
                <span class="kc">null</span><span class="p">,</span>
                <span class="kc">null</span><span class="p">,</span>
                <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">YELP_KEY</span><span class="p">,</span>
                <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">YELP_SECRET</span><span class="p">,</span>
                <span class="s2">"1.0"</span><span class="p">,</span>
                <span class="kc">null</span><span class="p">,</span>
                <span class="s2">"HMAC-SHA1"</span>
                <span class="p">)</span>
            <span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">baseUrl</span> <span class="o">+</span> <span class="s2">"?"</span> <span class="o">+</span> <span class="nx">stringToUrl</span><span class="p">(</span><span class="nx">options</span><span class="p">),</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">YELP_TOKEN</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">YELP_TOKEN_SECRET</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">reject</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s2">"content-type"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"application/json; charset=UTF-8"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">resolve</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">promise</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">search</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">city</span><span class="p">,</span> <span class="nx">sort</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">city</span><span class="p">,</span> <span class="nx">sort</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">};</span></code></pre></figure>

<p>Now we have a search function we can import into our express server that will allow us to query events with the filter “nightlife” by city, for up to 20 businesses at a time. We threw in the sort option to allow the user to filter results by match, distance, and rating. The Yelp API has many more options to choose from and this modular approach makes it easy to add additional parameters to our function and properties to our options object. One other thing to note is that we use the <mark>JSON.parse</mark> method to convert the returned string into a JSON object so we can access property names and values.</p>

<p>Next up is the <a href="https://developers.google.com/maps/documentation/directions/">Google Directions API</a>. The depth and accessability of Google APIs is truly massive with data on everything from books to machine learning. This module will follow a similar pattern as the Yelp one in that we’ll build a URL with options and then send that over to Google with a key for authentication. In this case, we won’t need OAuth. Google’s API has a chunk event we can use to build a string of data piece-by-piece and then return the data as a JSON on the end event.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// File name used for import is gmaps.js</span>

<span class="s2">"use strict"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">https</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"https"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">stringToUrl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./serialize.js"</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

	<span class="k">this</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">homeAddress</span><span class="p">,</span> <span class="nx">travelMode</span><span class="p">,</span> <span class="nx">wayPoints</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">baseUrl</span> <span class="o">=</span> <span class="s2">"https://maps.googleapis.com/maps/api/directions/json"</span><span class="p">;</span>

		<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">GOOGLE_MAPS_KEY</span><span class="p">;</span>

		<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
			<span class="na">origin</span><span class="p">:</span> <span class="nx">homeAddress</span><span class="p">,</span>
			<span class="na">destination</span><span class="p">:</span> <span class="nx">homeAddress</span><span class="p">,</span>
			<span class="na">mode</span><span class="p">:</span> <span class="nx">travelMode</span><span class="p">,</span>
			<span class="na">waypoints</span><span class="p">:</span> <span class="nx">wayPoints</span><span class="p">,</span>
			<span class="na">avoid</span><span class="p">:</span> <span class="s2">"tolls|highways|ferries"</span><span class="p">,</span>
			<span class="na">language</span><span class="p">:</span> <span class="s2">"english"</span><span class="p">,</span>
			<span class="na">units</span><span class="p">:</span> <span class="s2">"imperial"</span><span class="p">,</span>
			<span class="na">timeout</span><span class="p">:</span> <span class="mi">1000</span>
		<span class="p">};</span>

		<span class="kd">var</span> <span class="nx">promise</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">{</span>

			<span class="nx">https</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">baseUrl</span> <span class="o">+</span> <span class="s2">"?"</span> <span class="o">+</span> <span class="nx">stringToUrl</span><span class="p">(</span><span class="nx">options</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>

				<span class="nx">response</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"error"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
				<span class="p">});</span>

				<span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s2">"content-type"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"application/json; charset=UTF-8"</span><span class="p">)</span> <span class="p">{</span>

					<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

					<span class="nx">response</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chunk</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">data</span> <span class="o">+=</span> <span class="nx">chunk</span><span class="p">;</span>
					<span class="p">});</span>

					<span class="nx">response</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"end"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
						<span class="nx">resolve</span><span class="p">({</span>
							<span class="na">status</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">,</span>
							<span class="na">headers</span><span class="p">:</span> <span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">,</span>
							<span class="na">json</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
						<span class="p">});</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">});</span>
		<span class="p">});</span>
		<span class="k">return</span> <span class="nx">promise</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>We can now import these methods into our Express server and plug them into routes that can be accessed from a client-side request. In this example, there are some request (req.) arguments we pass into the API methods that have yet to be defined. Since these are sent from the client-side of the application, these will be built out in the next step.</p>

<p>There is an important string <mark>"optimize:true|"</mark> in the Google route. This little option tells the Google API to enable route optimization when searching for multiple locations, which according to the documentation is an application of the <a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">travelling salesman problem</a>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"express"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"mongoose"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"body-parser"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">Yelp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./yelp.js"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">yelpApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Yelp</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">GoogleMaps</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"./gmaps.js"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">googleApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GoogleMaps</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_URI</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s2">"/"</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"/api/search"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  
  <span class="nx">yelpApi</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">searchCity</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">sortBy</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">reason</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">"/api/directions"</span><span class="p">,</span> <span class="nx">isLoggedIn</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">wayPoints</span> <span class="o">=</span> <span class="s2">"optimize:true|"</span> <span class="o">+</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">eventLegs</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">"|"</span><span class="p">);</span>

  <span class="nx">googleApi</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">startAddress</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">travelMethod</span><span class="p">,</span> <span class="nx">wayPoints</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">json</span><span class="p">);</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">reason</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span> <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Listening on port "</span> <span class="o">+</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="p">);</span>
<span class="p">});</span></code></pre></figure>

<p>Cool! Our Express API is up and running. We can fire up the server and query the APIs with sample data. To take this project further, we could enable authentication to store user data, define schema to store data for users, and build out the client-side to view and send data to our server.</p>

<p>If you’d like to read on, we’ll build a sample view that sends form data to the Google Directions API. From the received data, we’ll generate a custom Google Map showing a polyline and indicating the most efficient route to reach our destinations.</p>

<p>In the code below, we create and style a basic form to receive user input. But part of the form HTML is missing - there are no locations. These elements are generated dynamically based on what events a user selects from the Yelp search results. At the bottom of the markup, we load the <mark>directions.js</mark> script and the Google Maps Javascript library. You’ll have to expose your API key here, but don’t worry as API searches can be restricted by domain from the Google Developer Console.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="nt">&lt;html&gt;</span>

    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;style&gt;</span>
            <span class="nc">.container</span> <span class="p">{</span>
                <span class="nl">display</span><span class="p">:</span> <span class="n">-webkit-flex</span><span class="p">;</span>
                <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
                <span class="nl">-webkit-flex-direction</span><span class="p">:</span> <span class="n">column</span><span class="p">;</span>
                <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">column</span><span class="p">;</span>
                <span class="nl">-webkit-align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
                <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
                <span class="nl">-webkit-justify-content</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
                <span class="nl">justify-content</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
                <span class="nl">background</span><span class="p">:</span> <span class="m">#0c0c13</span><span class="p">;</span>
                <span class="nl">border-top</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="m">#7b7882</span><span class="p">;</span>
                <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">2px</span> <span class="nb">solid</span> <span class="m">#7b7882</span><span class="p">;</span>    
                <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nc">.container</span> <span class="o">&gt;</span> <span class="nt">h2</span> <span class="p">{</span>
                <span class="nl">-webkit-flex</span><span class="p">:</span> <span class="m">1</span> <span class="m">1</span> <span class="nb">auto</span><span class="p">;</span>
                <span class="nl">flex</span><span class="p">:</span> <span class="m">1</span> <span class="m">1</span> <span class="nb">auto</span><span class="p">;</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">20px</span> <span class="m">0</span> <span class="m">0</span><span class="p">;</span>
                <span class="nl">font-weight</span><span class="p">:</span> <span class="m">100</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#form</span> <span class="p">{</span>
                <span class="nl">-webkit-flex</span><span class="p">:</span> <span class="m">1</span> <span class="m">1</span> <span class="nb">auto</span><span class="p">;</span>
                <span class="nl">flex</span><span class="p">:</span> <span class="m">1</span> <span class="m">1</span> <span class="nb">auto</span><span class="p">;</span>
                <span class="nl">width</span><span class="p">:</span> <span class="m">30em</span><span class="p">;</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="m">25px</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#form</span> <span class="o">&gt;</span> <span class="nt">label</span> <span class="p">{</span>
                <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="m">10px</span><span class="p">;</span>
                <span class="nl">font-weight</span><span class="p">:</span> <span class="m">100</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#form</span> <span class="o">&gt;</span> <span class="nt">label</span><span class="nd">:hover</span> <span class="p">{</span>
                <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#form</span> <span class="o">&gt;</span> <span class="nt">p</span> <span class="p">{</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">20px</span> <span class="m">0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"text"</span><span class="o">]</span> <span class="p">{</span>
                <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
                <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
                <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
                <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.5em</span><span class="p">;</span>
                <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">white</span><span class="p">;</span>
                <span class="nl">background</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"text"</span><span class="o">]</span><span class="nd">:focus</span> <span class="p">{</span>
                <span class="nl">outline</span><span class="p">:</span> <span class="nb">none</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"radio"</span><span class="o">]</span> <span class="p">{</span>
                <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"checkbox"</span><span class="o">]</span> <span class="p">{</span>
                <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"submit"</span><span class="o">]</span> <span class="p">{</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">20px</span> <span class="m">0</span> <span class="p">;</span>
                <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span> <span class="m">20px</span><span class="p">;</span>
                <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.5em</span><span class="p">;</span>
                <span class="nl">background</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
                <span class="nl">color</span><span class="p">:</span> <span class="m">#76FF03</span><span class="p">;</span>
                <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">white</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s1">"submit"</span><span class="o">]</span><span class="nd">:focus</span> <span class="p">{</span>
                <span class="nl">outline</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="nt">&lt;/style&gt;</span>
    <span class="nt">&lt;/head&gt;</span>

    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;h2&gt;</span>Find the best route to your events<span class="nt">&lt;/h2&gt;</span>
            <span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"form"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p&gt;</span>What's your starting address?<span class="nt">&lt;/p&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"start"</span> <span class="na">id=</span><span class="s">"startAddress"</span> <span class="na">required</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;p&gt;</span>How will you travel?<span class="nt">&lt;/p&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">name=</span><span class="s">"travelMethod"</span> <span class="na">id=</span><span class="s">"method-1"</span> <span class="na">value=</span><span class="s">"walking"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"method-1"</span><span class="nt">&gt;</span>Walking<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">name=</span><span class="s">"travelMethod"</span> <span class="na">id=</span><span class="s">"method-2"</span> <span class="na">value=</span><span class="s">"driving"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"method-2"</span><span class="nt">&gt;</span>Driving<span class="nt">&lt;/label&gt;</span>
                <span class="nt">&lt;p&gt;</span>Which places do you want to go?<span class="nt">&lt;/p&gt;</span>
                <span class="c">&lt;!-- Appended HTML will insert here --&gt;</span>
            <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map"</span><span class="nt">&gt;&lt;/div&gt;</span>    
        <span class="nt">&lt;/div&gt;</span>

        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"directions.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="nt">&lt;script </span><span class="na">async</span> <span class="na">defer</span> <span class="na">src=</span><span class="s">"https://maps.googleapis.com/maps/api/js?v=3&amp;key=AIzaSyBa0BY0W-oeI5kdpgD0mqjqI2zAIsXkM0Y&amp;libraries=geometry"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
    
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<p>To display options for finding directions, we need to append checkbox input elements with the business name to our HTML and when the form is submitted, transmit the address for those businesses to the Google Directions API. The Google API then returns a JSON with everything we need to build our map.</p>

<p>jQuery and AngularJS offer methods to generate HTML and send AJAX requests. We can also do this in plain Javascript. First we’ll send a request to our database of user data to request the saved events for a logged in user. Here is the Mongoose schema for reference:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s2">"use strict"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"mongoose"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">Schema</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">User</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Schema</span><span class="p">({</span>
    <span class="na">google</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">token</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="nb">String</span>
    <span class="p">},</span>
    <span class="na">events</span><span class="p">:</span> <span class="p">[</span>
	    <span class="p">{</span>
	    	<span class="na">business</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
	    	<span class="na">address</span><span class="p">:</span> <span class="nb">String</span>
	    <span class="p">}</span>
    <span class="p">]</span>
<span class="p">},</span> <span class="p">{</span> <span class="na">versionKey</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s2">"User"</span><span class="p">,</span> <span class="nx">User</span><span class="p">);</span></code></pre></figure>

<p>We send a GET request to obtain the user data in <mark>directions.js</mark> and interate over the events to create a checkbox for each entry. At the end, we append a submit button to complete the form.</p>

<p><mark>addSubmitListener()</mark> adds an eventlistener to our form that waits for a user submission. When the user hits the submit button, an object with the form data is passed to the function in our chain <mark>getDirectionData()</mark> shown in the next step.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

<span class="s2">"use strict"</span><span class="p">;</span>

<span class="nx">getUserData</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">getUserData</span><span class="p">()</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

	<span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"/api/user"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

	<span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

		<span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">request</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">)</span> <span class="p">{</span>

			<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
			
			<span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"form"</span><span class="p">);</span>

			<span class="nx">data</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>

				<span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"input"</span><span class="p">);</span>
				<span class="nx">input</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">"checkbox"</span><span class="p">;</span>
				<span class="nx">input</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">"box-"</span> <span class="o">+</span> <span class="nx">index</span><span class="p">;</span>
				<span class="nx">input</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">business</span><span class="p">;</span>
				<span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>
				<span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>

				<span class="kd">var</span> <span class="nx">label</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"label"</span><span class="p">);</span>
				<span class="nx">label</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">"for"</span><span class="p">,</span> <span class="s2">"box-"</span> <span class="o">+</span> <span class="nx">index</span><span class="p">);</span>
				<span class="nx">label</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">business</span><span class="p">;</span>
				<span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">label</span><span class="p">);</span>

			<span class="p">});</span>

			<span class="kd">var</span> <span class="nx">submit</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"input"</span><span class="p">);</span>
			<span class="nx">submit</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">"submit"</span><span class="p">;</span>
			<span class="nx">submit</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">"Get Route"</span><span class="p">;</span>
			<span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">submit</span><span class="p">);</span>

			<span class="nx">addSubmitListener</span><span class="p">(</span><span class="nx">form</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="nx">request</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Error: "</span> <span class="o">+</span> <span class="nx">request</span><span class="p">.</span><span class="nx">statusText</span><span class="p">);</span>
	<span class="p">};</span>
	<span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">addSubmitListener</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>

	<span class="nx">form</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"submit"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
		
		<span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

		<span class="kd">var</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"input"</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{};</span>

		<span class="nx">formData</span><span class="p">[</span><span class="s2">"eventLegs"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>

		<span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forEach</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">inputs</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>

			<span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="s2">"startAddress"</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">formData</span><span class="p">[</span><span class="nx">input</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="s2">"travelMethod"</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">checked</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">formData</span><span class="p">[</span><span class="nx">input</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="nx">input</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">"checkbox"</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">checked</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">formData</span><span class="p">[</span><span class="s2">"eventLegs"</span><span class="p">][</span><span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">});</span>
		<span class="nx">getDirectionData</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">}</span>

<span class="c1">// ... Script content continued below </span>

<span class="p">})();</span></code></pre></figure>

<p>We’re ready to send our form data to the Google Directions API endpoint we built earlier. The object data is converted to a string before sending. The server responds with a success status and we pass the received data to the next function <mark>initializeMap()</mark>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">getDirectionData</span><span class="p">(</span><span class="nx">formData</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

	<span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span> <span class="s2">"/api/directions"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

	<span class="nx">request</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json"</span><span class="p">);</span>

	<span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

		<span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">request</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">)</span> <span class="p">{</span>
			
			<span class="kd">var</span> <span class="nx">directionsData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>

			<span class="nx">initializeMap</span><span class="p">(</span><span class="nx">directionsData</span><span class="p">,</span> <span class="nx">formData</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Error: "</span> <span class="o">+</span> <span class="nx">request</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">formData</span><span class="p">));</span>
<span class="p">}</span></code></pre></figure>

<p>Because of hoisting in Javascript where function definitions are moved to the top of their scope, we can write out the map initialization in an order to show things step-by-step.</p>

<p>We define the google map and style the map with <mark>loadStyles()</mark> to match our app’s design and color scheme. <mark>fitbounds()</mark> takes the southwest and northeast coordinates and fits the map and <mark>setCenter()</mark> centers the map. The <mark>Polyline</mark> constructor takes a string that is encoded with all the points for the path between the event location.</p>

<p>For dropping marker pins for each event location, <mark>dropMarkers()</mark> iterates over the legs of the directions, which are returned by the API ordered by the shortest path. A closure is used to pass the iterator into a <mark>setTimeout</mark> function to stagger dropping the pins. <mark>addMarker()</mark> is what creates the marker with marker text. To add an info window on click, we use a closure to create local variables that assign the business name and address for the text.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">initializeMap</span><span class="p">(</span><span class="nx">directionsData</span><span class="p">,</span> <span class="nx">formData</span><span class="p">)</span> <span class="p">{</span>

	<span class="kd">var</span> <span class="nx">route</span> <span class="o">=</span> <span class="nx">directionsData</span><span class="p">.</span><span class="nx">routes</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">googleMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"map"</span><span class="p">),</span> <span class="p">{</span>
		<span class="s2">"clickableIcons"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="s2">"mapTypeId"</span><span class="p">:</span> <span class="s2">"roadmap"</span><span class="p">,</span>
		<span class="s2">"styles"</span><span class="p">:</span> <span class="nx">loadStyles</span><span class="p">()</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">mapBounds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">LatLngBounds</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">southwest</span><span class="p">,</span> <span class="nx">route</span><span class="p">.</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">northeast</span><span class="p">);</span>

    <span class="nx">googleMap</span><span class="p">.</span><span class="nx">fitBounds</span><span class="p">(</span><span class="nx">mapBounds</span><span class="p">);</span>
    <span class="nx">googleMap</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">(</span><span class="nx">mapBounds</span><span class="p">.</span><span class="nx">getCenter</span><span class="p">());</span>

    <span class="kd">var</span> <span class="nx">pathPolyline</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Polyline</span><span class="p">({</span>
		<span class="s2">"path"</span><span class="p">:</span> <span class="nx">getPathCoordinates</span><span class="p">(),</span>
		<span class="s2">"geodesic"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="s2">"strokeColor"</span><span class="p">:</span> <span class="s2">"#7C4DFF"</span><span class="p">,</span>
		<span class="s2">"strokeOpacity"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
		<span class="s2">"strokeWeight"</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">});</span>

    <span class="nx">pathPolyline</span><span class="p">.</span><span class="nx">setMap</span><span class="p">(</span><span class="nx">googleMap</span><span class="p">);</span>

    <span class="nx">dropMarkers</span><span class="p">();</span>

    <span class="kd">function</span> <span class="nx">getPathCoordinates</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">encoding</span><span class="p">.</span><span class="nx">decodePath</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">overview_polyline</span><span class="p">.</span><span class="nx">points</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="kd">function</span> <span class="nx">getPointCoords</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">route</span><span class="p">.</span><span class="nx">legs</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">leg</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="nx">leg</span><span class="p">.</span><span class="nx">end_location</span><span class="p">;</span>
		<span class="p">});</span>
	<span class="p">}</span>

	<span class="kd">function</span> <span class="nx">dropMarkers</span><span class="p">()</span> <span class="p">{</span>

		<span class="nx">route</span><span class="p">.</span><span class="nx">legs</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">leg</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
					<span class="nx">addMarker</span><span class="p">(</span><span class="nx">leg</span><span class="p">.</span><span class="nx">end_address</span><span class="p">,</span> <span class="nx">leg</span><span class="p">.</span><span class="nx">end_location</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
				<span class="p">},</span> <span class="mi">250</span> <span class="o">*</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
			<span class="p">})(</span><span class="nx">i</span><span class="p">);</span>
		<span class="p">});</span>
	<span class="p">}</span>

	<span class="kd">function</span> <span class="nx">addMarker</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">location</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
			<span class="s2">"map"</span><span class="p">:</span> <span class="nx">googleMap</span><span class="p">,</span>
			<span class="s2">"draggable"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
			<span class="s2">"animation"</span><span class="p">:</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Animation</span><span class="p">.</span><span class="nx">DROP</span><span class="p">,</span>
			<span class="s2">"place"</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">"location"</span><span class="p">:</span> <span class="nx">location</span><span class="p">,</span>
				<span class="s2">"placeId"</span><span class="p">:</span> <span class="nx">directionsData</span><span class="p">.</span><span class="nx">geocoded_waypoints</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">place_id</span>
			<span class="p">},</span>
			<span class="s2">"icon"</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">"url"</span><span class="p">:</span> <span class="s2">"../images/purple-icon.png"</span><span class="p">,</span>
				<span class="s2">"scaledSize"</span><span class="p">:</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Size</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
				<span class="s2">"labelOrigin"</span><span class="p">:</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Point</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
			<span class="p">},</span>
			<span class="s2">"label"</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">"text"</span><span class="p">:</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">toString</span><span class="p">(),</span>
				<span class="s2">"color"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">,</span>
				<span class="s2">"fontSize"</span><span class="p">:</span> <span class="s2">"20px"</span><span class="p">,</span>
				<span class="s2">"fontWeight"</span><span class="p">:</span> <span class="s2">"100"</span>
			<span class="p">},</span>

		<span class="p">});</span>

		<span class="kd">var</span> <span class="nx">infoWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">InfoWindow</span><span class="p">();</span>

		<span class="nx">marker</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="s2">"click"</span><span class="p">,</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">marker</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">infoWindow</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">googleMap</span><span class="p">,</span> <span class="nx">marker</span><span class="p">);</span>
				<span class="nx">infoWindow</span><span class="p">.</span><span class="nx">setContent</span><span class="p">(</span><span class="nx">matchAddress</span><span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">+</span> <span class="nx">address</span> <span class="o">+</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">);</span>				
			<span class="p">}</span>
		<span class="p">})(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">marker</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="kd">function</span> <span class="nx">matchAddress</span><span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">street</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">address</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">","</span><span class="p">));</span>

		<span class="k">if</span> <span class="p">(</span><span class="nx">formData</span><span class="p">.</span><span class="nx">startAddress</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">street</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="s2">"&lt;b&gt;Starting Address&lt;/b&gt;&lt;br&gt;"</span><span class="p">;</span>
		<span class="p">};</span>

		<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">eventLegs</span><span class="p">)</span> <span class="p">{</span>

			<span class="k">if</span> <span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">street</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="s2">"&lt;b&gt;"</span> <span class="o">+</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">eventLegs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"&lt;/b&gt;&lt;br&gt;"</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="s2">""</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="kd">function</span> <span class="nx">loadStyles</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">[</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"all"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"labels.text.fill"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#ffffff"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"all"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"labels.text.stroke"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#000000"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"administrative"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.fill"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#000000"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"administrative"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.stroke"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#1B5E20"</span>
		            <span class="p">},</span>
		            <span class="p">{</span>
		                <span class="s2">"weight"</span><span class="p">:</span> <span class="mi">1</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"landscape"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"all"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#212121"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"poi"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#424242"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"road.highway"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.fill"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#000000"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"road.highway"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.stroke"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#B2FF59"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"road.arterial"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.fill"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#000000"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"road.arterial"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry.stroke"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#33691E"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"road.local"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#000000"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"transit.line"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"all"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#CCFF90"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		   	<span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"transit.station"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"geometry"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#424242"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">},</span>
		    <span class="p">{</span>
		        <span class="s2">"featureType"</span><span class="p">:</span> <span class="s2">"water"</span><span class="p">,</span>
		        <span class="s2">"elementType"</span><span class="p">:</span> <span class="s2">"all"</span><span class="p">,</span>
		        <span class="s2">"stylers"</span><span class="p">:</span> <span class="p">[</span>
		            <span class="p">{</span>
		                <span class="s2">"color"</span><span class="p">:</span> <span class="s2">"#37474F"</span>
		            <span class="p">}</span>
		        <span class="p">]</span>
		    <span class="p">}</span>
		<span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Congrats! We’ve built an API that can pull data from Yelp and Google APIs and give users an efficient order and route to their events. Thanks for reading and please let me know if you have any feedback or suggestions.</p>

  </div>
  <p class="article-date">
    <time datetime="2016-08-25T00:00:00-07:00" itemprop="datePublished">Aug 25, 2016</time>
    
  </p>
</article>

      </div>
    </main>
    <footer class="footer">
  <ul>
    <li>Created by Joe McIlhargey - 2016.</li>
    <li>Some projects inspired by Freecodecamp, Udacity, and Codecademy</li>
  </ul>
</footer>
  </body>
</html>
